<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fortune Cookie Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #FDF2E9;
            background-image: radial-gradient(#E5A974 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .fortune-cookie-container {
            perspective: 1000px;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent; /* Removes blue tap highlight on mobile */
        }
        .cookie {
            width: 200px;
            height: 100px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .cookie-half {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #F5CBA7; /* Cookie color */
            border: 5px solid #E5A974;
            border-bottom: none;
            border-radius: 100px 100px 0 0;
            box-sizing: border-box;
            backface-visibility: hidden;
            box-shadow: inset 0 -10px 15px -5px rgba(0,0,0,0.1);
        }
        .cookie-half.left {
            transform-origin: bottom center;
        }
        .cookie-half.right {
            transform-origin: bottom center;
        }
        .fortune-paper {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #333;
            padding: 15px 25px;
            width: 240px;
            text-align: center;
            border-radius: 5px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.6s 0.4s ease-out;
            font-family: 'Playfair Display', serif;
            line-height: 1.4;
            transform-style: preserve-3d;
            backface-visibility: hidden;
        }

        /* Animation State */
        .cracked .cookie-half.left {
            animation: crack-left 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
        }
        .cracked .cookie-half.right {
            animation: crack-right 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
        }
        .cracked .fortune-paper {
            opacity: 1;
            transform: translateX(-50%) translateY(-45px) rotateZ(-2deg);
        }

        @keyframes crack-left {
            0% { transform: rotate(0deg) translateX(0) translateY(0); }
            50% { transform: rotate(-10deg) translateX(-25px) translateY(5px); }
            100% { transform: rotate(-5deg) translateX(-60px) translateY(20px) scale(0.95); }
        }
        @keyframes crack-right {
            0% { transform: rotate(0deg) translateX(0) translateY(0); }
            50% { transform: rotate(10deg) translateX(25px) translateY(5px); }
            100% { transform: rotate(5deg) translateX(60px) translateY(20px) scale(0.95); }
        }

        .title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }
        
        button:disabled {
            cursor: not-allowed;
            background-color: #AF601A;
            opacity: 0.7;
        }
    </style>
</head>
<body class="bg-[#FDF2E9] flex flex-col items-center justify-center min-h-screen p-4">

    <div id="app-container" class="text-center w-full max-w-lg mx-auto bg-[#FDF2E9]/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg">
        <h1 class="title text-4xl md:text-5xl text-[#D35400] mb-4">Your Daily Fortune</h1>
        <p id="subtitle" class="text-lg text-[#AF601A] mb-12">Click the cookie to reveal your fortune! You get two per day.</p>

        <div id="fortune-container" class="fortune-cookie-container h-48 flex items-center justify-center">
            <div class="cookie">
                <div class="cookie-half left"></div>
                <div class="cookie-half right"></div>
            </div>
            <p id="fortune-paper" class="fortune-paper">Your fortune awaits...</p>
        </div>

        <button id="new-fortune-btn" class="mt-12 bg-[#D35400] text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-[#E67E22] transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-[#F5CBA7]">
            Crack Open a New Cookie
        </button>
    </div>

    <script>
        const fortunes = [
            "Of all the stars in the universe, yours is shining the brightest today.",
            "The world is a better place for having you in it.",
            "Your unique perspective is exactly what's needed right now.",
            "Something you thought was lost will soon be found.",
            "You have a gift for making the ordinary feel extraordinary.",
            "Today, you are someone's reason to smile.",
            "Your potential is limitless. Don't forget it.",
            "A small act of kindness you perform will ripple out in wonderful ways.",
            "You're on the verge of a brilliant idea. Pay attention to your thoughts.",
            "The energy you're putting out into the world is about to come back to you, multiplied.",
            "You have a strength inside you that you haven't even discovered yet.",
            "Someone is thinking of you with a smile on their face right now.",
            "Your creativity is a treasure. Share it with the world.",
            "Don't be afraid to take up space. Your presence is a gift.",
            "You are more loved and appreciated than you realize."
        ];

        const fortuneContainer = document.getElementById('fortune-container');
        const fortunePaper = document.getElementById('fortune-paper');
        const newFortuneBtn = document.getElementById('new-fortune-btn');
        const subtitle = document.getElementById('subtitle');

        let isCracked = false;
        let canClick = true;

        function checkDailyLimit() {
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            let usageData = JSON.parse(localStorage.getItem('fortuneCookieUsage')) || { date: today, count: 0 };

            if (usageData.date !== today) {
                // It's a new day, reset the counter
                usageData = { date: today, count: 0 };
                localStorage.setItem('fortuneCookieUsage', JSON.stringify(usageData));
            }

            if (usageData.count >= 2) {
                subtitle.textContent = "You've had your two fortunes for today. Come back tomorrow!";
                fortuneContainer.style.cursor = 'not-allowed';
                newFortuneBtn.disabled = true;
                return false; // Limit reached
            }
            
            const remaining = 2 - usageData.count;
            subtitle.textContent = `Click the cookie to reveal your fortune! You have ${remaining} left today.`;
            return true; // Can get a fortune
        }

        function incrementUsage() {
            const today = new Date().toISOString().split('T')[0];
            // **FIXED**: Initialize usageData if it's null to prevent errors on the first click.
            let usageData = JSON.parse(localStorage.getItem('fortuneCookieUsage')) || { date: today, count: 0 };
            usageData.count++;
            localStorage.setItem('fortuneCookieUsage', JSON.stringify(usageData));
            checkDailyLimit(); // Update UI after incrementing
        }

        function getFortune() {
            if (!canClick || !checkDailyLimit()) return;
            canClick = false;

            if (isCracked) {
                fortuneContainer.classList.remove('cracked');
                setTimeout(() => {
                    showNewFortune();
                    fortuneContainer.classList.add('cracked');
                    incrementUsage();
                    canClick = true;
                }, 1200);
            } else {
                showNewFortune();
                fortuneContainer.classList.add('cracked');
                incrementUsage();
                isCracked = true;
                canClick = true;
            }
        }

        function showNewFortune() {
            const randomIndex = Math.floor(Math.random() * fortunes.length);
            fortunePaper.textContent = fortunes[randomIndex];
        }

        // Event Listeners
        fortuneContainer.addEventListener('click', getFortune);
        newFortuneBtn.addEventListener('click', getFortune);

        // Initial check on page load
        window.onload = checkDailyLimit;
    </script>

</body>
</html>
